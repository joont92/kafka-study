# 프로듀서 주요 옵션

#### bootstrap.servers
카프카 클러스터내에 있는 브로커들은 `마스터`라는 개념이 없기 때문에, 클러스터 내 모든 브로커가 클라이언트의 요청을 받을 수 있다  
이 옵션은 카프카에 처음 연결을 하기 위한 호스트의 주소(+포트)를 나타낸다  
단순히 엔드포인트일 뿐이고, 클라이언트가 이곳으로 요청을 보내게되면 내부에서 브로커들끼리 리플리케이션을 하게 되므로 모든 브로커의 주소를 다 입력할 필요는 없다  
하지만 엔드포인트로 쓴 브로커에 장애가 발생할 경우 클러스터에 요청을 전달할 게이트웨이가 막히는 꼴이 되므로, 브로커 리스트를 전체 다 입력하는 것을 권장한다고 한다  
(접속에 장애가 발생할 경우 다른 서버로 재접속을 시도함)  

라고 생각했는데, 추가로 확인이 더 필요할 것 같다  // TODO  
- bootstrap.server 에 명시한 url 로 메시지를 보내게 될텐데, 명시한 url 에 리더 브로커가 없다면 어떻게 될까?
- 이를 방지하기 위해 zookeeper url 을 써야할 것 같은데, 왜 kafak 는 zookeeper 를 안쓰는 방향으로 점점 가는걸까?

#### acks
프로듀서가 메시지를 보내고 그 메시지를 카프카가 잘 받았는지 확인을 할 것인지 또는 확인을 하지 않을 것인지를 결정하는 옵션이다
- acks=0 : 응답을 확인하지 않음
- acks=1 : 리더의 응답만을 확인함
- acks=2 : 팔로워의 응답까지 확인함(`min.insync.replicas` 속성의 영향을 받음)

#### compression.type
프로듀서가 데이터를 압축해서 보낼 수 있는데, 어떤 타입으로 압축할 지 정하는 옵션이다  
none, gzip, snappy, lz4 등 다양한 포멧 중 하나를 선택할 수 있다  

#### retries
일시적인 오류로 인해 전송에 실패한 데이터를 다시 보내는 횟수  

#### batch.size, linger.ms
프로듀서에서 데이터를 배치로 보낼 떄 사용하는 옵션들이다  
- 데이터가 `batch.size` 만큼 쌓이면 카프카로 메시지를 전송한다  
- 만약 `batch.size` 보다 큰 데이터가 들어올 경우 배치를 시도하지 않고 바로 전송한다
- 배치를 보내기 전 프로듀서에 장애가 발생하면 배치로 쌓고있던 메시지는 전달되지 않는다
- `batch.size` 에 도달하지 못하더라도 `linger.ms` 시간만큼 지나면 카프카로 메시지를 전송한다

#### buffer.memory
tcp 버퍼처럼 acks 를 받아오기 전에 메시지를 임시로 저장해두는 공간이다(아마도) // TODO